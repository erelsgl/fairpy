#!python3

""" 
A demo program for finding leximin allocations.

Author: Erel Segal-Halevi
Since:  2021-06
"""

from fairpy.items.leximin import *

import sys

logger.addHandler(logging.StreamHandler(sys.stdout))
logger.setLevel(logging.INFO)

import fairpy
from fairpy import solve

solve.logger.addHandler(logging.StreamHandler(sys.stdout))
solve.logger.setLevel(logging.INFO)

import cvxpy_leximin

cvxpy_leximin.LOGGER.addHandler(logging.StreamHandler(sys.stdout))
cvxpy_leximin.LOGGER.setLevel(logging.INFO)


def show(title, v):
    print("\n", "###", title)
    z = fairpy.divide(leximin_optimal_allocation, v, upper_tolerance=1.02).round(3)
    # print(type(z))
    # print("agent_bundle_value_matrix\n", z.agent_bundle_value_matrix)
    print("allocation = \n", z)
    print("utility profile\n", z.utility_profile())


show("3 agents, competitive", [[3,2,1],[1,2,3],[2,2,2]])
# show("3 agents, non-competitive", [[3,0,0],[0,4,0],[0,0,5]])
# show("3 agents, non-competitive", [[3,0,0],[0,3,0],[0,0,5]])
# show("4 agents, partially-competitive", [[4,0,0],[0,3,0],[5,5,10],[5,5,10]])
# show("6 agents, partially-competitive", [[3,0,0],[0,8,0],[0,8,0],[5,5,15],[5,5,15],[5,5,15]])


# show(
#     "2 parties",
#     [
#         [1 / 3, 0, 1 / 3, 1 / 3],
#         [1, 1, 1, 0],
#     ],
# )


large1 = {
    'agent0': {'x0': 1.0, 'x1': 0.0, 'x2': 0.0, 'x3': 0.0, 'x4': 0.0, 'x5': 444.0, 'x6': 0.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 0.0, 'x11': 333.0, 'x12': 222.0, 'x13': 0.0, 'x14': 0.0},
    'agent1': {'x0': 334.0, 'x1': 0.0, 'x2': 0.0, 'x3': 0.0, 'x4': 444.0, 'x5': 0.0, 'x6': 0.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 0.0, 'x11': 222.0, 'x12': 0.0, 'x13': 0.0, 'x14': 0.0},
    'agent2': {'x0': 223.0, 'x1': 0.0, 'x2': 0.0, 'x3': 0.0, 'x4': 0.0, 'x5': 0.0, 'x6': 444.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 0.0, 'x11': 0.0, 'x12': 333.0, 'x13': 0.0, 'x14': 0.0},
    'agent3': {'x0': 1.0, 'x1': 444.0, 'x2': 0.0, 'x3': 0.0, 'x4': 0.0, 'x5': 222.0, 'x6': 0.0, 'x7': 0.0, 'x8': 333.0, 'x9': 0.0, 'x10': 0.0, 'x11': 0.0, 'x12': 0.0, 'x13': 0.0, 'x14': 0.0},
    'agent4': {'x0': 1.0, 'x1': 0.0, 'x2': 0.0, 'x3': 0.0, 'x4': 0.0, 'x5': 0.0, 'x6': 0.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 333.0, 'x11': 222.0, 'x12': 444.0, 'x13': 0.0, 'x14': 0.0},
    'agent5': {'x0': 1.0, 'x1': 222.0, 'x2': 0.0, 'x3': 0.0, 'x4': 0.0, 'x5': 0.0, 'x6': 0.0, 'x7': 0.0, 'x8': 333.0, 'x9': 0.0, 'x10': 0.0, 'x11': 0.0, 'x12': 0.0, 'x13': 444.0, 'x14': 0.0},
    'agent6': {'x0': 223.0, 'x1': 0.0, 'x2': 0.0, 'x3': 444.0, 'x4': 0.0, 'x5': 0.0, 'x6': 333.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 0.0, 'x11': 0.0, 'x12': 0.0, 'x13': 0.0, 'x14': 0.0},
    'agent7': {'x0': 1.0, 'x1': 0.0, 'x2': 444.0, 'x3': 0.0, 'x4': 0.0, 'x5': 0.0, 'x6': 0.0, 'x7': 0.0, 'x8': 0.0, 'x9': 333.0, 'x10': 222.0, 'x11': 0.0, 'x12': 0.0, 'x13': 0.0, 'x14': 0.0},
    'agent8': {'x0': 1.0, 'x1': 0.0, 'x2': 0.0, 'x3': 0.0, 'x4': 0.0, 'x5': 0.0, 'x6': 0.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 0.0, 'x11': 333.0, 'x12': 222.0, 'x13': 444.0, 'x14': 0.0},
    'agent9': {'x0': 1.0, 'x1': 0.0, 'x2': 0.0, 'x3': 0.0, 'x4': 0.0, 'x5': 0.0, 'x6': 0.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 333.0, 'x11': 444.0, 'x12': 222.0, 'x13': 0.0, 'x14': 0.0},
    'agent10': {'x0': 1.0, 'x1': 0.0, 'x2': 333.0, 'x3': 0.0, 'x4': 0.0, 'x5': 444.0, 'x6': 0.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 0.0, 'x11': 222.0, 'x12': 0.0, 'x13': 0.0, 'x14': 0.0},
    'agent11': {'x0': 1.0, 'x1': 444.0, 'x2': 0.0, 'x3': 0.0, 'x4': 0.0, 'x5': 0.0, 'x6': 333.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 0.0, 'x11': 222.0, 'x12': 0.0, 'x13': 0.0, 'x14': 0.0},
    'agent12': {'x0': 334.0, 'x1': 0.0, 'x2': 0.0, 'x3': 0.0, 'x4': 0.0, 'x5': 0.0, 'x6': 222.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 0.0, 'x11': 0.0, 'x12': 444.0, 'x13': 0.0, 'x14': 0.0},
    'agent13': {'x0': 1.0, 'x1': 0.0, 'x2': 0.0, 'x3': 444.0, 'x4': 0.0, 'x5': 0.0, 'x6': 0.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 0.0, 'x11': 333.0, 'x12': 0.0, 'x13': 0.0, 'x14': 222.0},
    'agent14': {'x0': 223.0, 'x1': 0.0, 'x2': 0.0, 'x3': 0.0, 'x4': 0.0, 'x5': 0.0, 'x6': 0.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 0.0, 'x11': 333.0, 'x12': 444.0, 'x13': 0.0, 'x14': 0.0}
}
large2 = {
    'agent0': {'x0': 667.0, 'x1': 0.0, 'x2': 333.0}, 
    'agent1': {'x0': 667.0, 'x1': 0.0, 'x2': 333.0}, 
    'agent2': {'x0': 667.0, 'x1': 333.0, 'x2': 0.0}, 
    'agent3': {'x0': 333.0, 'x1': 667.0, 'x2': 0.0}, 
    'agent4': {'x0': 667.0, 'x1': 333.0, 'x2': 0.0}, 
    'agent5': {'x0': 667.0, 'x1': 333.0, 'x2': 0.0}, 
    'agent6': {'x0': 333.0, 'x1': 0.0, 'x2': 667.0},
    'agent7': {'x0': 333.0, 'x1': 667.0, 'x2': 0.0}, 
    'agent8': {'x0': 667.0, 'x1': 333.0, 'x2': 0.0}, 
    'agent9': {'x0': 667.0, 'x1': 333.0, 'x2': 0.0}, 
    'agent10': {'x0': 667.0, 'x1': 333.0, 'x2': 0.0},
    'agent11': {'x0': 667.0, 'x1': 0.0, 'x2': 333.0}, 
    'agent12': {'x0': 0.0, 'x1': 333.0, 'x2': 667.0}, 
    'agent13': {'x0': 333.0, 'x1': 667.0, 'x2': 0.0}, 
    'agent14': {'x0': 667.0, 'x1': 0.0, 'x2': 333.0}
}
large3 = {'agent0': {'x0': 133.0, 'x1': 133.0, 'x2': 133.0, 'x3': 133.0, 'x4': 133.0, 'x5': 0.0, 'x6': 0.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 67.0, 'x11': 67.0, 'x12': 67.0, 'x13': 67.0, 'x14': 67.0}, 'agent1': {'x0': 133.0, 'x1': 133.0, 'x2': 133.0, 'x3': 133.0, 'x4': 133.0, 'x5': 0.0, 'x6': 0.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 67.0, 'x11': 67.0, 'x12': 67.0, 'x13': 67.0, 'x14': 67.0}, 'agent2': {'x0': 133.0, 'x1': 133.0, 'x2': 133.0, 'x3': 133.0, 'x4': 133.0, 'x5': 67.0, 'x6': 67.0, 'x7': 67.0, 'x8': 67.0, 'x9': 67.0, 'x10': 0.0, 'x11': 0.0, 'x12': 0.0, 'x13': 0.0, 'x14': 0.0}, 'agent3': {'x0': 67.0, 'x1': 67.0, 'x2': 67.0, 'x3': 67.0, 'x4': 67.0, 'x5': 133.0, 'x6': 133.0, 'x7': 133.0, 'x8': 133.0, 'x9': 133.0, 'x10': 0.0, 'x11': 0.0, 'x12': 0.0, 'x13': 0.0, 'x14': 0.0}, 'agent4': {'x0': 133.0, 'x1': 133.0, 'x2': 133.0, 'x3': 133.0, 'x4': 133.0, 'x5': 67.0, 'x6': 67.0, 'x7': 67.0, 'x8': 67.0, 'x9': 67.0, 'x10': 0.0, 'x11': 0.0, 'x12': 0.0, 'x13': 0.0, 'x14': 0.0}, 'agent5': {'x0': 133.0, 'x1': 133.0, 'x2': 133.0, 'x3': 133.0, 'x4': 133.0, 'x5': 67.0, 'x6': 67.0, 'x7': 67.0, 'x8': 67.0, 'x9': 67.0, 'x10': 0.0, 'x11': 0.0, 'x12': 0.0, 'x13': 0.0, 'x14': 0.0}, 'agent6': {'x0': 67.0, 'x1': 67.0, 'x2': 67.0, 'x3': 67.0, 'x4': 67.0, 'x5': 0.0, 'x6': 0.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 133.0, 'x11': 133.0, 'x12': 133.0, 'x13': 133.0, 'x14': 133.0}, 'agent7': {'x0': 67.0, 'x1': 67.0, 'x2': 67.0, 'x3': 67.0, 'x4': 67.0, 'x5': 133.0, 'x6': 133.0, 'x7': 133.0, 'x8': 133.0, 'x9': 133.0, 'x10': 0.0, 'x11': 0.0, 'x12': 0.0, 'x13': 0.0, 'x14': 0.0}, 'agent8': {'x0': 133.0, 'x1': 133.0, 'x2': 133.0, 'x3': 133.0, 'x4': 133.0, 'x5': 67.0, 'x6': 67.0, 'x7': 67.0, 'x8': 67.0, 'x9': 67.0, 'x10': 0.0, 'x11': 0.0, 'x12': 0.0, 'x13': 0.0, 'x14': 0.0}, 'agent9': {'x0': 133.0, 'x1': 133.0, 'x2': 133.0, 'x3': 133.0, 'x4': 133.0, 'x5': 67.0, 'x6': 67.0, 'x7': 67.0, 'x8': 67.0, 'x9': 67.0, 'x10': 0.0, 'x11': 0.0, 'x12': 0.0, 'x13': 0.0, 'x14': 0.0}, 'agent10': {'x0': 133.0, 'x1': 133.0, 'x2': 133.0, 'x3': 133.0, 'x4': 133.0, 'x5': 67.0, 'x6': 67.0, 'x7': 67.0, 'x8': 67.0, 'x9': 67.0, 'x10': 0.0, 'x11': 0.0, 'x12': 0.0, 'x13': 0.0, 'x14': 0.0}, 'agent11': {'x0': 133.0, 'x1': 133.0, 'x2': 133.0, 'x3': 133.0, 'x4': 133.0, 'x5': 0.0, 'x6': 0.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 67.0, 'x11': 67.0, 'x12': 67.0, 'x13': 67.0, 'x14': 67.0}, 'agent12': {'x0': 0.0, 'x1': 0.0, 'x2': 0.0, 'x3': 0.0, 'x4': 0.0, 'x5': 67.0, 'x6': 67.0, 'x7': 67.0, 'x8': 67.0, 'x9': 67.0, 'x10': 133.0, 'x11': 133.0, 'x12': 133.0, 'x13': 133.0, 'x14': 133.0}, 'agent13': {'x0': 67.0, 'x1': 67.0, 'x2': 67.0, 'x3': 67.0, 'x4': 67.0, 'x5': 133.0, 'x6': 133.0, 'x7': 133.0, 'x8': 133.0, 'x9': 133.0, 'x10': 0.0, 'x11': 0.0, 'x12': 0.0, 'x13': 0.0, 'x14': 0.0}, 'agent14': {'x0': 133.0, 'x1': 133.0, 'x2': 133.0, 'x3': 133.0, 'x4': 133.0, 'x5': 0.0, 'x6': 0.0, 'x7': 0.0, 'x8': 0.0, 'x9': 0.0, 'x10': 67.0, 'x11': 67.0, 'x12': 67.0, 'x13': 67.0, 'x14': 67.0}}

show("large1",large1)
show("large2",large2)
show("large3",large3)
